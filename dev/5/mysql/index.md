# MySQL索引

```
1.什么是索引
2.为什么要用索引
3.索引优势和劣势
4.索引类型
5.索引存储方式
6.索引失效场景
```
## 1.什么是索引
```
索引是用于快速查找记录的一种数据结构
```

## 2.为什么要用索引
```
索引就是为了提高查询效率,就像书的目录.其实说白了,索引要解决的就是查询问题
```


## 3.索引优势和劣势

### 3.1 索引优势
```
索引大大减小了服务器需要扫描的数据量,索引可以帮助服务器避免排序和临时表,索引可以将随机IO变成顺序IO,从而提高查询速度.
```

### 3.2 索引劣势
```
虽然索引大大提高了查询速度,同时却会占用磁盘空间和降低更新表的速度.如对表进行INSERT、UPDATE和DELETE.
因为更新表时,MySQL不仅要保存数据,还要保存索引文件
创建和维护索引需要时间成本, 并且这个时间成本随着数据量的增大而加大
```


## 4.索引类型
```
1. 普通索引: 表中的普通列创建的索引,这是最基本的索引,它没有任何限制

2. 唯一索引: 索引列的值必须唯一,但允许空值,如果是组合索引,则列值的组合必须唯一

3. 主键索引: 是一种特殊的唯一索引,不允许重复,不允许空值

4. 全文索引: 用大文本对象的列构建的索引,索引列支持值得全文查找,全文索引可以在varchar、char、text类型上创建,
全文索引的查询也有自己特殊的语法,而不能使用LIKE %查询字符串%的模糊查询语法

5. 空间索引: 空间索引是对空间数据类型的字段建立的索引,MySQL 中的空间数据类型有四种,GEOMETRY、POINT、
LINESTRING、POLYGON.创建空间索引的列,必须将其声明为 NOT NULL

6. 组合索引: 用多个列组合构建的索引,在表中的多个字段组合上创建的索引,只有在查询条件中使用了这些字段的左边字段时,
索引才会被使用,使用组合索引时遵循最左前缀集合
```


## 5.索引存储方式

### 5.1 hash索引
```
哈希索引基于哈希表实现,只有精确索引所有列的查询才有效
哈希索引结构的特殊性,其检索效率非常高,索引的检索可以一次定位,由于 Hash 索引比较的是进行 Hash 运算之后的 Hash 值,
所以它只能用于等值的过滤,不能用于基于范围的过滤.Hash 索引是将索引键通过 Hash 运算之后,将 Hash运算结果的 Hash 值
和所对应的行指针信息存放于一个 Hash 表中,由于不同索引键存在相同 Hash 值,所以即使取满足某个 Hash 键值的数据的记录条数,
也无法从 Hash 索引中直接完成查询,还是要通过访问表中的实际数据进行相应的比较,并得到相应的结果,
Hash索引遇到大量Hash值相等的情况后性能并不一定就会比B-Tree索引高
```

### 5.2 btree索引
```
B-Tree通常意味着所有的值都是按顺序存储的,并且每一个叶子页到根的距离相同,很适合查找范围数据
B-Tree 索引是 MySQL 数据库中使用最为频繁的索引类型.仅仅在 MySQL 中是如此,实际上在其他的很
多数据库管理系统中B-Tree 索引也同样是作为最主要的索引类型,这主要是因为B-Tree 索引的存储结构
在数据库的数据检索中有非常优异的表现,它适合范围查询
```


## 6.索引失效场景
```txt
1.隐式转换导致不走索引(即字段类型不一致)
  示例: 如age是数字,但是使用字符串值作为筛选条件:select age where age = '2'

2.like模糊查询时,当%在前缀时,索引失效

3.组合索引不符合最左前缀原则,索引失效

4.索引列上有函数运算,索引失效

5.is null或者is not null 可能会导致索引失效

6.连表查询字段类型一致,但是字符类型不一致一会导致,索引失效

7.Note：例如 or 、in | not in 、is null | is not null、!=、<>,使用时并不是完全不走索引,
要考虑到:
  1、全表扫描是否比索引更快，以至于优化器选择全表扫描
  2、mysql-server 的版本
  3、可以通过优化语法或者配置优化器走索引.参考：statement-optimization.html、select-optimization.html、optimization-indexes.html
```